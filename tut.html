<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Github Page for XtalOpt, an evolutionary algortihm designed to predict crystal structures.">
  <meta name="author" content="Zackary Falls">
  <link rel="icon" href="dist/img/xtalopt-logo.png">
  <title>
      XtalOpt - Tutorials
  </title>

  <!-- Scripts -->
  <script src="dist/js/jquery.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67403311-1', 'auto');
    ga('send', 'pageview');

  </script>
  <script type="text/javascript" src='dist/js/bootstrap.min.js'></script>
    <script>
      $(function(){
        $("#navbar").load("navbar.html");
      });
    </script>
    <script>
      $(function() {
        var pgurl = window.location.href.substr(window.location.href.lastIndexOf("/")+1);
        $(".navbar .nav a").each(function(){
          if($(this).attr("href") == pgurl || $(this).attr("href") == '' )
            $(this).addClass("active");
        })
      });
    </script>

  <!-- Styles -->
  <link href="dist/css/bootstrap.css" rel="stylesheet">
  <link href="dist/css/bootstrap-responsive.css" rel="stylesheet">
  <link href="dist/css/style.css" rel="stylesheet">

  <!-- Fav and touch icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="dist/img/xtalopt-logo.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="dist/img/xtalopt-logo.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="dist/img/xtalopt-logo.png">
  <link rel="apple-touch-icon-precomposed" href="dist/img/xtalopt-logo.png">
  <link rel="shortcut icon" href="dist/img/xtalopt-logo.png">
</head>

  <body>
    <!--NavBar-->
    <div id="navbar"></div>

    <div class="container">
      <div class="jumbotron">
        <h1>XtalOpt Tutorial</h1>
      <br>
        <p>
        PDF format available <a class="el" target="_blank" href="docs/xtalopt/latex/refman.pdf" onclick="ga('send','event','PDF','Download','tutorial');">here</a>
        </p>
      </div>

      <br>

      <div class="jumbotron">
        <h2 align="left">Contents</h2>
        <hr>
        <ul align="left" style="text-align:-moz-left">
            <li><a class="el" href="tut.html#launch">Launch XtalOpt</a></li>
            <li><a class="el" href="tut.html#init">Enter composition and restraints</a></li>
            <li><a class="el" href="tut.html#opt">Optimizer setup</a><ul>
                <li><a class="el" href="tut.html#vasp-opt">VASP</a></li>
                <li><a class="el" href="tut.html#gulp-opt">GULP</a></li>
                <li><a class="el" href="tut.html#pwscf-opt">PWscf</a></li>
                <li><a class="el" href="tut.html#castep-opt">CASTEP</a></li>
                <li><a class="el" href="tut.html#siesta-opt">SIESTA</a></li>
            </ul>
            </li>
            <li><a class="el" href="tut.html#qisetup">Queue setup</a><ul>
                <li><a class="el" href="tut.html#remotepbs">Using a remote PBS cluster</a></li>
                <li><a class="el" href="tut.html#remotesge">Using a remote SGE cluster</a></li>
                <li><a class="el" href="tut.html#remoteslurm">Using a remote SLURM cluster</a></li>
                <li><a class="el" href="tut.html#remotelsf">Using a remote LSF cluster</a></li>
                <li><a class="el" href="tut.html#remotell">Using a remote LoadLeveler cluster</a></li>
                <li><a class="el" href="tut.html#localqi">Running optimizations locally</a></li>
            </ul>
            </li>
            <li><a class="el" href="tut.html#files">What is written to the local directory?</a></li>
            <li><a class="el" href="tut.html#search-set">Search Settings</a></li>
            <li><a class="el" href="tut.html#begin">"Begin"</a></li>
            <li><a class="el" href="tut.html#prog-mon">Monitor progress</a><ul>
                <li><a class="el" href="tut.html#trends">View trends</a></li>
            </ul>
            </li>
            <li><a class="el" href="tut.html#optschemes">Optimization Schemes</a></li>
            <ul>
                <li><a class="el" href="tut.html#quick-over">In a nutshell..</a></li>
                <li><a class="el" href="tut.html#detailed-over">More details</a></li>
</li>
<li><a class="el" href="tut.html#gui">Optimization scheme user interface</a><ul>
<li><a class="el" href="tut.html#gui-list">Optimization step list</a></li>
<li><a class="el" href="tut.html#gui-add">Add new optimization step</a></li>
<li><a class="el" href="tut.html#gui-rem">Remove current optimization step</a></li>
<li><a class="el" href="tut.html#gui-tselect">Select template</a></li>
<li><a class="el" href="tut.html#gui-editor">Template editor</a></li>
<li><a class="el" href="tut.html#gui-save">Save scheme</a></li>
<li><a class="el" href="tut.html#gui-load">Resume scheme</a></li>
</ul>
</li>
<li><a class="el" href="tut.html#creating">How to build an optimization scheme?</a></li>
<li><a class="el" href="tut.html#saving">How to save an optimization scheme for later?</a></li>
<li><a class="el" href="tut.html#loading">How to load an optimization scheme?</a></li>
<li><a class="el" href="tut.html#format">What is saved?</a></li>
<li><a class="el" href="tut.html#suggest">Suggestions for optimization schemes</a>
  <ul>
    <li><a class="el" href="tut.html#sug-xtal">Crystals (XtalOpt)</a></li>
  </ul>
</li>
   </ul>             
     <li><a class="el" href="tut.html#sr">Saving and Resuming Sessions in XtalOpt</a>
     <ul>
       <li><a class="el" href="tut.html#sr_saving">How to save your session</a></li>
       <li><a class="el" href="tut.html#sr_resuming">How to resume your session</a></li>
     </ul>   
     </li>
     <li><a class="el" href="tut.html#randomdock">RandomDock Tutorial</a></li>
 </ul>
      </div>

      <a class="anchor" id="launch">
        <br>
      </a>

      <br>

      <div class="jumbotron">
        <h2>Launch XtalOpt</h2>
        <p>Open avogadro, go to the "Extensions" menu and select "XtalOpt".</p>
      </div>

      <a class="anchor" id="init">
        <br>
      </a>

      <div class="jumbotron">
        <h2>Enter composition and restraints</h2>
        <div align="center">
            <img src="dist/img/struct-lim.png" alt="struct-lim.png" width="80%">
        </div>
        <br>
        <p>The interface opens to the "Structure Limits" tab, shown above. We will use a 6 formula unit supercell of titanium dioxide for this tutorial, so enter "Ti6 O12" for the cell composition. We will assume that we know nothing about the system and use very loose restraints (however, note that a search is much more effective if chemically reasonable restraints are used). Set all cell length minima to 1 angstrom and maxima to 20 angstroms. Constrain the angles to be between 60 and 120 degrees, and the volume from between 1 and 500 cubic angstroms. Specify a minimum interatomic distance of 0.5 angstroms. (Note that due to the angle adjustment described in <a href="preprints/2010-CPIP-lonie-zurek">CPC, 2011, 182, 372-387</a>, 60-120 degrees is the largest range of cell angles that XtalOpt will generate.)</p>
      </div>

      <a class="anchor" id="opt">
        <br>
      </a>

      <div class="jumbotron">
         <h2>Optimizer setup</a></h2>
         <p>XtalOpt currently supports the <a class="el" href="tut.html#vasp-opt">VASP</a>, <a class="el" href="tut.html#gulp-opt">GULP</a>, <a class="el" href="tut.html#pwscf-opt">PWscf</a>, <a class="el" href="tut.html#castep-opt">CASTEP</a>, and <a class="el" href="tut.html#siesta-opt">SIESTA</a> codes for performing geometry optimizations. Each is detailed in its own section below.</p>



<!-- VASP -->
    <a class="anchor" id="vasp-opt">
        <br><br>
    </a>

    <h3>VASP</h3>
        <img src="dist/img/opt-set-vasp.png" alt="opt-set-vasp.png" width="80%">
        <br>
        <br>
        <p>
        On the next tab, load the optimization scheme by clicking the "Load
Opt Scheme" button and selecting the "samples/vasp-xtalopt.scheme" file that is distributed with the source code. If you do not have a copy of the source code, the scheme file can be obtained by clicking <a href="samples/vasp-xtalopt.scheme">here</a>.</p>
<p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
<p>After loading the optimization scheme, XtalOpt will prompt for the POTCAR files to use. Select files appropriate for the prompted atom. XtalOpt will construct the POTCAR files on the local computer, and then copy them over to the cluster when the calculation is submitted. It is necessary to have the VASP POTCAR files for each atomic species located somewhere on the local computer. See the VASP manual for information on obtaining the POTCAR files.</p>
<p>Take a moment to look through each file for each optimization step. Notice that the INCAR template includes two user-specified values, %user2% and %user3% for the external pressure and the energy cutoff, respectively. By entering appropriate values in the "user2:" and "user3:" fields on the left, it is easy to update these values for all optimization steps.</p>
<p>Notice the other %keyword% values in the job.pbs templates. These are used to enter information that is specific to a search or structure when the actual input files are written prior to job submission. Click the "Help" button for a full listing of the available keywords.</p>
<p>XtalOpt expects VASP to use the default filenames, mainly POSCAR, CONTCAR, and OUTCAR.</p>
<p><a class="el" href="tut.html#qisetup">Skip to next section.</a></p>



<!-- GULP -->
    <a class="anchor" id="gulp-opt">
        <br><br>
    </a>

<h3>GULP</h3>
<img src="dist/img/opt-set-gulp.png" alt="opt-set-gulp.png" width="80%">
        <br>
        <br>
 <p>On the next tab we choose GULP for the local optimizer and enter a template for GULP to use. Select "GULP" as the "Optimizer" and "xtal.gin" as "Template". Next, fill out the text field on the right with the following template: </p>

 <pre align="left" style="text-align:-moz-left">opti conj conp
switch_minimiser bfgs gnorm 0.5

cell
  %a% %b% %c% %alphaDeg% %betaDeg% %gammaDeg%

frac
  %coordsFrac%

species
  Ti 2.196
  O -1.098

buck
  Ti Ti 31120.1 0.1540 5.25  15
  O  O  11782.7 0.2340 30.22 15
  Ti O  16957.5 0.1940 12.59 15

lennard 12 6
  Ti Ti 1 0 15
  O  O  1 0 15
  Ti O  1 0 15</pre>
 <br>

 <p>
 Alternatively, one can load the scheme file distributed with the source code under samples/gulp-TiO-xtalopt.scheme. If the source code is not available, the scheme file can be obtained by clicking <a href="samples/gulp-TiO-xtalopt.scheme">here</a>.
 </p>
 <p>
 For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.
 </p>
<p>
Note the "%" surrounding various keywords. These will be replaced by the structure-specific data when the optimizer is invoked for each structure. Click "Help" to view all of the keywords available. The number of optimization steps can be modified with the "Add/Resume" buttons. The "user" fields in the lower left corner allow users to specify their own keyword/value pairs, which is useful for making changes to multiple optimization steps at once. We will only be using one optimization step in this tutorial.
</p>
<p>
XtalOpt expects GULP to use the following filenames:
</p>
<div align="center">
    <pre>gulp &lt; xtal.gin &gt; xtal.got</pre>
</div>
<br>

<p>
  <a class="el" href="tut.html#qisetup">Skip to next section.</a>
</p>

    <a class="anchor" id="pwscf-opt">
        <br><br>
    </a>

<h3>PWscf</h3>
<img src="dist/img/opt-set-pwscf.png" alt="opt-set-pwscf.png" width="80%">
        <br>
        <br>
 <p>On the next tab, load the optimization scheme that is distributed with the source code under the samples/ directory. The scheme that we want is named "pwscf-xtalopt.scheme". If the source code is not available, the scheme file can be obtained by clicking the "Original Format" link at the bottom of the page <a href="samples/pwscf-xtalopt.scheme">here</a>.</p>
 <p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
<p>Each PWscf input file will need to be edited to specify:</p>
<ol type="1" align=left style="text-align:-moz-left">
  <li>The pseudo_dir containing the pseudopotential files on the remote cluster, and</li>
  <li>The pseudopotentials for each atom (under ATOMIC_SPECIES)</li>
</ol>
<br>
<p>Take a moment to look through each file for each optimization step.</p>
<p>Notice the %keyword% values in the job.pbs templates. These are used to enter information that is specific to a search or structure when the actual input files are written prior to job submission. Click the "Help" button for a full listing of the available keywords.</p>
<p>Be aware that every PWscf/CASTEP installation is different, and it is almost certain that the job.pbs file included with this scheme will not work on any cluster other than the Zurek group's "parity" cluster at SUNY Buffalo's Center for Computational Resources. It may take some experimentation to get jobs to submit successfully, and you may need to contact the system administrators of the cluster for assistance for information about MPI, executable locations, etc. Perhaps the easiest method to find the correct PBS script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>XtalOpt expects PWscf to use the following filenames:</p>

<div class="fragment"><div class="line"><pre>pw.x &lt; xtal.in &gt; xtal.out</pre></div>
</div><!-- fragment --><p>

<br>
<a class="el" href="tut.html#qisetup">Skip to next section.</a></p>

    <a class="anchor" id="castep-opt">
        <br><br>
    </a>

<h3>CASTEP</h3>
<img src="dist/img/opt-set-castep.png" alt="opt-set-castep.png" width="80%">
        <br>
        <br>
 <p>On the next tab, load the optimization scheme that is distributed with the source code under the samples/ directory. The scheme that we want is named "castep-xtalopt.scheme". If the source code is not available, the scheme file can be obtained by clicking the "Original Format" link at the bottom of the page <a href="samples/castep-xtalopt.scheme">here</a>.</p>
 <p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
<p>It is important to note that CASTEP input files require the "%" character to define blocks. The percent character is special in the XtalOpt input template parser to define keywords (see below). To insert a literal "%" into the input, use percent%.</p>
<p>E.g. Specification of the fractional coordinate block in the .cell template should look like:</p>


<div class="fragment"><div class="line">%percent%BLOCK POSITIONS_FRAC</div>
<div class="line">%coordsFrac%</div>
<div class="line">%percent%ENDBLOCK POSITIONS_FRAC</div>
</div><!-- fragment --><p>Take a moment to look through each file for each optimization step.</p>


<p>Notice the %keyword% values in the job.pbs templates. These are used to enter information that is specific to a search or structure when the actual input files are written prior to job submission. Click the "Help" button for a full listing of the available keywords.</p>
<p>Be aware that every PWscf/CASTEP installation is different, and it is almost certain that the job.pbs file included with this scheme will not work on any cluster other than the Zurek group's "parity" cluster at SUNY Buffalo's Center for Computational Resources. It may take some experimentation to get jobs to submit successfully, and you may need to contact the system administrators of the cluster for assistance for information about MPI, executable locations, etc. Perhaps the easiest method to find the correct PBS script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>XtalOpt expects CASTEP to use the following filenames:</p>


<div class="fragment"><div class="line"><span class="preprocessor"># XtalOpt will write xtal.cell, xtal.param</span></div>
<div class="line">castep xtal</div>
<div class="line"><span class="preprocessor"># CASTEP will create xtal.castep</span></div>
</div><!-- fragment -->
<br>

<p>
  <a class="el" href="tut.html#qisetup">Skip to next section.</a>
</p>


    <a class="anchor" id="siesta-opt">
        <br><br>
    </a>

    <h3>SIESTA</h3>

    <p>On the next tab we choose SIESTA for the local optimizer and enter a template for SIESTA to use. Select "SIESTA" as the "Optimizer" and "xtal.fdf" as "Template".</p>

    <p>Next, fill out the text field on the right with the following template:</p>

 <pre align="left" style="text-align:-moz-left">SystemName %description%
SystemLabel %description%-%gen%x%id%

NumberOfAtoms %numAtoms%
NumberOfSpecies %numSpecies%

%block Chemical_Species_Label
%chemicalSpeciesLabel%
%endblock Chemical_Species_Label

PAO.BasisSize SZ

# Lattice, coordinates, k-sampling
AtomicCoordinatesFormat Fractional
AtomicCoorFormatOut Ang

%block% AtomicCoordinatesAndAtomicSpecies
%atomicCoordsAndAtomicSpecies%
%endblock% AtomicCoordinatesAndAtomicSpecies

LatticeConstant 4.10 Ang
%block% LatticeVectors
%cellMatrixAngstrom%
%endblock% LatticeVectors

kgrid_cutoff 7. Ang

# DFT, Grid, SCF
XC.functional LDA # Exchange-correlation functional type
XC.authors CA # Particular parametrization of xc func
SpinPolarized .false. # Spin unpolarized calculation
MeshCutoff 200. Ry # Equivalent planewave cutoff for the grid
MaxSCFIterations 100 # Maximum number of SCF iterations per step
DM.MixingWeight 0.3 # New DM amount for next SCF cycle
DM.Tolerance 1.d-4 # Tolerance in maximum difference

# between input and output DM
DM.NumberPulay 3 # Number of SCF steps between pulay mixing

# Eigenvalue problem: order-N or diagonalization
SolutionMethod diagon # OrderN or Diagon
ElectronicTemperature 5 K # Temp. for Fermi smearing

# Molecular dynamics and relaxations
MD.TypeOfRun cg # Type of dynamics:</pre>

 <p>Or load the optimization scheme by clicking the "Load Opt Scheme" button and selecting the "samples/siesta-xtalopt.scheme" file that is distributed with the source code.</p>

 <p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>

 <p>After loading the optimization scheme, XtalOpt will prompt for the xtal.psf files to use. Select files appropriate for the prompted atom. XtalOpt will copy the individual files over to each structure directory when the calculation is submitted. See the SIESTA manual for information on obtaining the .psf files.</p>

 <p>Notice the other %keyword% values in the xtal.fdf templates. These are used to enter information that is specific to a search or structure when the actual input files are written prior to job submission. Click the "Help" button for a full listing of the available keywords.</p>

 <p>Note that in the current implementation XtalOpt uses the Total Final Energy printed in the output to determine the fitness of a structure. If the user would like to use a different thermodynamic quantity for the fitness, please contact the XtalOpt developers.</p>

 <p>XtalOpt expects SIESTA to use the following filenames:</p>

 <pre>siesta < xtal.fdf > xtal.out</pre>

 </div>


    <a class="anchor" id="qisetup">
      <br>
    </a>

      <div class="jumbotron">
<h2>Queue setup</h2>
<p>XtalOpt currently supports using the <a class="el" href="tut.html#remotepbs">PBS</a>, <a class="el" href="tut.html#remotesge">SGE</a>, <a class="el" href="tut.html#remoteslurm">SLURM</a>, <a class="el" href="tut.html#remotelsf">LSF</a>, and <a class="el" href="tut.html#remotell">LoadLeveler</a> queuing systems on remote SSH-accessible clusters, as well as an internal <a class="el" href="tut.html#localqi">local</a> queue that manages calculations on the user's workstation. Each queueing interface is detailed in its own section below.</p>



<!-- Remote - SGE -->
    <a class="anchor" id="remotepbs">
        <br><br>
    </a>

<h3>Using a remote PBS cluster</h3>
<img src="dist/img/opt-set-pbs.png" alt="opt-set-pbs.png" width="50%">
    <br>
    <br>
 <p>Select "PBS" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
 <ul align="left" style="text-align:-moz-left">
<li>host: The hostname of the PBS cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to qsub: Where to find the qsub executable on the remote cluster. Note that if qsub is in the cluster's $PATH, setting this to just 'qsub' will work.</li>
<li>Path to qdel: Where to find the qdel executable on the remote cluster. Note that if qdel is in the cluster's $PATH, setting this to just 'qdel' will work.</li>
<li>Path to qstat: Where to find the qstat executable on the remote cluster. Note that if qstat is in the cluster's $PATH, setting this to just 'qstat' will work.</li>
</ul>
<p>A new template, "job.pbs" is added to the list of available templates. This is the job submission script for PBS. This script should roughly follow this design:</p>

<div class="fragment"><div class="line"><span class="preprocessor">#/bin/bash</span></div>
<div class="line"><span class="preprocessor">#PBS -l nodes=1:ppn=8</span></div>
<div class="line"><span class="preprocessor">#PBS -o ../%gen%x%id%-%optstep%.out</span></div>
<div class="line"><span class="preprocessor">#PBS -e ../%gen%x%id%-%optstep%.err</span></div>
<div class="line"><span class="preprocessor">#PBS -N %description%-%gen%x%id%-%optstep%</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">###Include this for XtalOpt scripts!###</span></div>
<div class="line">export PBS_O_WORKDIR=%rempath%</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Change to structure&#39;s working directory, copy input files to node&#39;s scratch dirs:</span></div>
<div class="line"><span class="keywordflow">for</span> node in `cat $PBS_NODEFILE | sort | uniq`; <span class="keywordflow">do</span></div>
<div class="line">rsh $node <span class="stringliteral">&quot;cp $PBS_O_WORKDIR/* $PBSTMPDIR/;&quot;</span>;</div>
<div class="line">done</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Move to the scratch directory</span></div>
<div class="line">cd $PBSTMPDIR</div>
<div class="line">echo <span class="stringliteral">&quot;running in directory $PBSTMPDIR&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Set any environment variables needed for the optimizer/MPI here:</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Run optimizer, be sure to use the filenames that XtalOpt expects.</span></div>
<div class="line"><span class="preprocessor"># See the template menu in XtalOpt and the example templates in the</span></div>
<div class="line"><span class="preprocessor"># samples/ directory of the XtalOpt sources.</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Don&#39;t forget to clean up after MPI if needed!</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Print files from each node</span></div>
<div class="line"><span class="keywordflow">for</span> node in `cat $PBS_NODEFILE | sort | uniq`; <span class="keywordflow">do</span></div>
<div class="line">echo <span class="stringliteral">&quot;$node:&quot;</span></div>
<div class="line">rsh $node <span class="stringliteral">&quot;ls -l $PBSTMPDIR&quot;</span></div>
<div class="line">done</div>
<div class="line"><span class="preprocessor"># Copy back results from master node&#39;s scratch directory</span></div>
<div class="line"><span class="preprocessor">cp $PBSTMPDIR</span><span class="comment">/* $PBS_O_WORKDIR/</span></div>
</div><!-- fragment -->


<p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
<p>Be aware that every installation is different, and it is almost certain that the job.pbs file included with this scheme will not work on any cluster other than the Zurek group's "parity" cluster at SUNY Buffalo's Center for Computational Resources. It may take some experimentation to get jobs to submit successfully, and you may need to contact the system administrators of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct PBS script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>A handy trick for monitoring jobs outside of XtalOpt is to include the following line in job.pbs:</p>

<div class="fragment"><div class="line"><span class="preprocessor">#PBS -N %description%-%gen%x%id%-%optstep%</span></div>
</div><!-- fragment -->

<p>This will name each job, for example, xtalSearch-3x4-2, where xtalSearch is a user-specified description of the search, and 3x4-2 means that it is the fourth structure in the third generation running its second optimization step.</p>
<br>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>



<!-- Remote - SGE -->
    <a class="anchor" id="remotesge">
        <br><br>
    </a>

<h3>Using a remote SGE cluster</h3>
<img src="dist/img/opt-set-sge.png" alt="opt-set-sge.png" width="50%"/>
<br>
<br>
<p>Select "SGE" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
<ul align=left style="text-align:-moz-left">
<li>host: The hostname of the SGE cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to qsub: Where to find the qsub executable on the remote cluster. Note that if qsub is in the cluster's $PATH, setting this to just 'qsub' will work.</li>
<li>Path to qdel: Where to find the qdel executable on the remote cluster. Note that if qdel is in the cluster's $PATH, setting this to just 'qdel' will work.</li>
<li>Path to qstat: Where to find the qstat executable on the remote cluster. Note that if qstat is in the cluster's $PATH, setting this to just 'qstat' will work.</li>
<li>"Clean remote directories when finished": will remove all of the generated files from the cluster. Only the files on the local computer will be kept. If you do not want this to occur, make sure to uncheck this option.</li>
</ul>
<p>A new template, "job.sge" is added to the list of available templates. This is the job submission script for SGE. It may take some experimentation to get jobs to submit successfully, and you may need to contact the system administrators of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct SGE script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>



<!-- Remote - SLURM -->
    <a class="anchor" id="remoteslurm">
        <br><br>
    </a>

<h3>Using a remote SLURM cluster</h3>
<img src="dist/img/opt-set-slurm.png" alt="opt-set-slurm.png" width="50%"/>
<br>
<br>
<p>Select "SLURM" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
 <ul align=left style="text-align:-moz-left">
<li>host: The hostname of the SGE cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to sbatch: Where to find the sbatch executable on the remote cluster. Note that if sbatch is in the cluster's $PATH, setting this to just 'sbatch' will work.</li>
<li>Path to scancel: Where to find the scancel executable on the remote cluster. Note that if scancel is in the cluster's $PATH, setting this to just 'scancel' will work.</li>
<li>Path to squeue: Where to find the squeue executable on the remote cluster. Note that if squeue is in the cluster's $PATH, setting this to just 'squeue' will work.</li>
<li>"Clean remote directories when finished": will remove all of the generated files from the cluster. Only the files on the local computer will be kept. If you do not want this to occur, make sure to uncheck this option.</li>
</ul>
<p>A new template, "job.slurm" is added to the list of available templates. This is the job submission script for SLURM. It may take some experimentation to get jobs to submit successfully, and you may need to contact the system administrators of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct SLURM script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>



<!-- Remote - LSF -->
    <a class="anchor" id="remotelsf">
        <br><br>
    </a>

<h3>Using a remote LSF cluster</h3>
<img src="dist/img/opt-set-lsf.png" alt="opt-set-lsf.png" width="50%"/>
<br>
<br>
<p>Select "LSF" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
 <ul align=left style="text-align:-moz-left">
<li>host: The hostname of the LSF cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to bsub: Where to find the bsub executable on the remote cluster. Note that if bsub is in the cluster's $PATH, setting this to just 'bsub' will work.</li>
<li>Path to bkill: Where to find the bkill executable on the remote cluster. Note that if bkill is in the cluster's $PATH, setting this to just 'bkill' will work.</li>
<li>Path to bjobs: Where to find the bjobs executable on the remote cluster. Note that if bjobs is in the cluster's $PATH, setting this to just 'bjobs' will work.</li>
<li>"Clean remote directories when finished": will remove all of the generated files from the cluster. Only the files on the local computer will be kept. If you do not want this to occur, make sure to uncheck this option.</li>
</ul>
<p>A new template, "job.lsf" is added to the list of available templates. This is the job submission script for LSF. It may take some experimentation to get jobs to submit successfully, and you may need to contact the system administrators of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct LSF script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>



<!-- Remote - LoadLeveler -->
    <a class="anchor" id="remotell">
        <br><br>
    </a>

<h3>Using a remote LoadLeveler cluster</h3>
<img src="dist/img/opt-set-ll.png" alt="opt-set-ll.png" width="50%"/>
<br>
<br>
<p>Select "LoadLeveler" from the list of Queues, and then click the "Configure..." button. A new window will prompt for:</p>
 <ul align=left style="text-align:-moz-left">
<li>host: The hostname of the LoadLeveler cluster's head node</li>
<li>user: The username used to log into the cluster</li>
<li>Working directory (Server): A directory that is readable/writable by "user" on the cluster, used when performing optimizations.</li>
<li>Working directory (Local): A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
<li>Description: Used for the %description% keyword in input templates.</li>
<li>Path to llsubmit: Where to find the llsubmit executable on the remote cluster. Note that if llsubmit is in the cluster's $PATH, setting this to just 'llsubmit' will work.</li>
<li>Path to llcancel: Where to find the llcancel executable on the remote cluster. Note that if llcancel is in the cluster's $PATH, setting this to just 'llcancel' will work.</li>
<li>Path to llq: Where to find the llq executable on the remote cluster. Note that if llq is in the cluster's $PATH, setting this to just 'llq' will work.</li>
<li>"Clean remote directories when finished": will remove all of the generated files from the cluster. Only the files on the local computer will be kept. If you do not want this to occur, make sure to uncheck this option.</li>
</ul>
<p>A new template, "job.ll" is added to the list of available templates. This is the job submission script for LoadLeveler. It may take some experimentation to get jobs to submit successfully, and you may need to contact the system administrators of the cluster for assistance or information about MPI, executable locations, etc. Perhaps the easiest method to find the correct LoadLeveler script is to run some trial submissions by hand, and then replace the structure/search specific information with the appropriate keywords once a working script has been generated.</p>
<p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
<p><a class="el" href="tut.html#files">Skip to next section.</a></p>





    <a class="anchor" id="localqi">
        <br><br>
    </a>

<h3>Running optimizations locally</h3>
<img src="dist/img/opt-set-local.png" alt="opt-set-local.png" width="25%">
<br>
<br>
 <p>Select "Local" from the list of Queues, and then click the configure button. A new window will prompt for:</p>
 <ul align=left style="text-align:-moz-left">
<li>Local working directory: A directory that is readable/writable by the current user on the local computer. This is where the final structures and resume files are written.</li>
</ul>
<p>If the optimizer's executable (vasp, gulp, pw.x, castep, etc) is not in your system path, you will need to specify the location of the executable by clicking the "Configure..." button next to the optimizer selection menu.</p>
<p>For more details on optimization schemes, see <a class="el" href="tut.html#optschemes">optschemes</a>.</p>
</div>



    <a class="anchor" id="files">
        <br>
    </a>

      <div class="jumbotron">
<h2>What is written to the local directory?</h2>
<p>A directory for each structure is created at</p>
<div class="fragment"><div class="line">[Local working directory]/&lt;gen#&gt;x&lt;id#&gt;</div>
</div><!-- fragment --><p>that will contain input, output, and data files specific to each structure. Two additional files are also written to the local filesystem:</p>
<div class="fragment"><div class="line">[Local working directory]/xtalopt.state</div>
</div><!-- fragment --><p>which contains save/resume information to continue a session that has been stopped, and</p>
<div class="fragment"><div class="line">[Local working directory]/results.txt</div>
</div><!-- fragment --><p>which stores a list of all structures sorted by increasing enthalpy. The latter file is handy for offline analysis, since there is no need to open XtalOpt to find the most stable structures of a previous search.</p>
    </div>



    <a class="anchor" id="search-set">
        <br><br>
    </a>

    <div class="jumbotron">
<h2>Search Settings</h2>
<div class="image">
<img src="dist/img/search-set.png" alt="search-set.png" width="80%"/>
</div>
 <p>In the "Search Settings" tab, most of the default settings should suffice (See <a href="preprints/2010-CPIP-lonie-zurek">CPC, 2011, 182, 372-387</a>). We arbitrarily set the initial structures to 20 and the continuous structures to 5, although these may need to be adjusted based on available resources. We will not specify initial seeds, but the option to do so exists on this screen.</p>
<p>It is not neccessary to limit the number of running jobs unless running locally, as the PBS queue on the cluster will manage job control for us. If running locally, set the job limit no higher than [number of available processor cores] - 1 (e.g. for a quadcore processor, allow three jobs to run simultaneously). This allows one core to remain free for the system to run.</p>
<p>There is now a termination criteria called "Total Number of Structures" that will end the run once a certain number of structures have been produced by XtalOpt.</p>
    </div>



    <a class="anchor" id="begin">
        <br><br>
    </a>

    <div class="jumbotron">
<h2>"Begin"</h2>
<div class="image">
<img src="dist/img/prog-start.png" alt="prog-start.png" width="80%"/>
<div class="caption">
The ``Progress'' tab immediately after starting a search</div></div>
<p>XtalOpt has everything it needs to start its search at this point; click the "Begin" button in the lower right corner of the application to tell it to start the search algorithm. A progress bar appears as the random first generation is created. Switch to the "Progress" tab and 20 entries will appear, all with a status of "Waiting for
Optimization". Click "Refresh" on this tab to begin the local optimizations. From here, XtalOpt will continue to run without user input, starting new optimizations and generating new structures until it is stopped by the user.</p>
    </div>

    <a class="anchor" id="prog-mon">
        <br><br>
    </a>

    <div class="jumbotron">
<h2>Monitor progress</h2>
<div class="image">
<img src="dist/img/prog-mon.png" alt="prog-mon.png" width="80%"/>
<div class="caption">
The ``Progress'' tab mid-run</div></div>
<p>As XtalOpt performs the search, the progress table continuously updates, providing information about each structure. We see individuals in various stages of completion: most are optimized (in blue), structure 2x2 has been automatically marked as a duplicate (dark green) of structure 1x2 and removed from the breeding pool, structure 3x4 is currently undergoing a local optimization (light green), while structure 2x10 is waiting to be optimized (light blue).</p>
<p>Other useful information is displayed about each structure, such as the time spent in optimization, the optimized enthalpy, the cell volume, spacegroup, and each structure's ancestory (i.e. parent(s) and parameters for the genetic operator that generated it). A status bar on the bottom of the window shows the number of structures that are optimized, running, and failing at any given time. This information is visible regardless of which tab is currently being viewed.</p>
<p>An additional feature of the progress table is the ability to immediately visualize any of the individuals in the Avogadro main window &ndash; simply clicking on a row in this table will display the three-dimensional structure in Avogadro, where it can be visualized, modified, or exported. If the user would like to add a bit of "intelligent design" to the evolutionary process, a structure can be modified and then resubmitted using a context (right-click) menu from the progress table. The context menu provides tools to (un)kill a structure, resubmit for local optimization at an arbitrary optimization step, or replace a problematic structure with a new, random individual.</p>
<p>Three additional buttons found near the "Refresh All" button in this tab are also available. The "Print Results File" button generates a run-results.txt file that lists all of the information about each structure in order of generation and structure number (As compared to the results.txt file which ranks the structures). The "Remove Extra Files" button is used for VASP runs. It removes any extraneous files in each local subdirectory in order to reduce disk usage. Files kept are structure.state, POTCAR, CONTCAR, OSZICAR, job.slurm and OUTCAR. Finally, the "Rank All" button ranks all currently optimized structures and exports them to a subdirectory (Ranked) in two forms (depending on the optimizer): POSCAR/.got and .cif. Each can be found in separate directories. (Only works for GULP and VASP runs currently).</p>
<h3><a class="anchor" id="trends"></a>
View trends</h3>
<div class="image">
<img src="dist/img/trend-view.png" alt="trend-view.png" width="80%"/>
<div class="caption">
The ``Plot'' tab mid-run displaying enthalpy vs. volume. Each structure is labeled with its Hermann Mauguin spacegroup symbol.</div></div>
<p>Another visualization and analysis tool available during the search is the interactive plot. The plot is capable of investigating trends in the search by plotting a point for each individual using structure number, generation number, enthalpy, energy, $PV$ enthalpy term, lattice parameters, or cell volume on either axis. This powerful feature allows the user to visualize complex relationships present in the generated structures. E.g., a plot of enthalpy vs. structure number provides an overview of the search's progress. Or, recalling that H = U + PV, plotting enthalpy vs. PV enthalpy term or energy lends insight into whether the enthalpy (H) is dominated by atomic interactions (U) or cell parameters (PV). Further information is available by labeling the points with the individual's spacegroup number, Hermann Mauguin spacegroup symbol, enthalpy, energy, PV term, volume, generation, or index number.</p>
<p>A particularly useful plot is that of enthalpy vs. cell volume, as shown above. From this view, we see a general trend that enthalpy increases with volume (the effect is much more pronounced for systems at higher pressures), and also that below a certain volume enthalpy rises sharply. From this data set, we see that there is a cluster of very low enthalpy structures with cell volumes around 180 cubic angstroms. Armed with this data, we can update the starting volume on the Structure Limits tab mid-run to reflect this new piece of information that the search has provided us. Many of the other parameters governing structure generation and algorithm specifics can be similarly modified during a search without the need to restart the algorithm.</p>
<p>The plot is also interactive; zooming and panning are possible using simple mouse controls. Clicking on a structure's point on the plot will load it in the main Avogadro window, allow all the same functionality as described above in <a class="el" href="tut.html#prog-mon">Monitor progress</a>.</p>
    </div>



<!-- Optimization Schemes -->
    <a class="anchor" id="optschemes"> 
        <br><br>
    </a>

    <div class="jumbotron">
    <h1>What are optimimization schemes, and why use them?</h1>



    <a class="anchor" id="quick-over">
        <br><br>
    </a>
    
    <h2>In a nutshell..</h2>
    
    <p>An optimization scheme is a series of optimization steps ("optsteps") that are to be performed in sequence on a structure. Each optimization step consists of a set of input file templates for the queuing system and optimizer to be used, and the structure is updated after each completes. So if an optimization scheme contains three optimization steps, a stucture's lifecycle is:</p>
    <ol align=left style="text-align:-moz-left" type="1">
        <li>Generation of initial structure</li>
        <li>Perform optstep 1 on initial structure</li>
        <li>Update structure from the results of optstep 1</li>
        <li>Perform optstep 2 on current structure (result of optstep 1)</li>
        <li>Update structure from the results of optstep 2</li>
        <li>Perform optstep 3 on current structure (result of optstep 2)</li>
        <li>Update structure from the results of optstep 3</li>
        <li>Current structure (result of optstep 3) is either accepted into the breeding pool or discarded, depending on its enthalpy relative to the other optimized structures.</li>
    </ol>



    <a class="anchor" id="detailed-over">
        <br><br>
    </a>
    
    <h2>More details</h2>
    
    <p>The efficiency of searching a potential energy surface for a global minimum can be significantly improved by moving each candidate structure to the nearest local minimum, i.e. performing a geometry optimization. The differences between searching with and without carrying out these local optimizations are explored in detail in Woodley SM, Catlow CRA. Comp. Mat. Sci. 2009;45(1):84-95 (Available at: <a href="http://linkinghub.elsevier.com/retrieve/pii/S0927025608003030">http://linkinghub.elsevier.com/retrieve/pii/S0927025608003030</a> ).</p>

    <p>Why not just perform a single geometry optimization on each structure? Stochastic search techniques, such as XtalOpt, will often need to perform geometry optimizations on structures that are far from a stationary point on the potential energy surface. For example, the randomly generated structures in the first generation of an evolutionary search are often highly disordered with unrealistic atomic separations. If these structures were to be optimized in a single step with accurately small convergence criteria, it would be quite expensive. Also, it is more than likely that most of the optimizations would not finish successfully before reaching the maximum number of geometry steps allowed by the optimizer or specified in the input. A second issue is that complex structures (periodic crystals, for example) often have so many degrees of freedom that convergence in a single step is difficult from a poor starting point (consider the effect on atomic coordinates when a unit cell's translation vector is modified).</p>

    <p>The first problem (effectively optimizing to small convergence) can be solved by implementing an optimization scheme that optimizes to successively smaller convergence cutoffs.</p>

    <p>The second problem can be addressed by reducing the degrees of freedom in the early optsteps and only optimizing everything once each component has individually converged to a reasonable parameterization. See <a class="el" href="tut.html#suggest">Suggestions for optimization schemes</a> for examples.</p>



    <a class="anchor" id="gui">
        <br><br>
    </a>
    <h2>Optimization scheme user interface</h2>

    <br>
    <div class="image">
<img src="dist/img/optschemes-numberededitor.png" alt="optschemes-numberededitor.png" width="80%"/>
</div>
 <p>We will use the above screenshot as we describe the process of creating, saving, and loading optimization schemes. The numbers indicate:</p>
<ol align=left style="text-align:-moz-left" type="1">
    <li>List of optimization steps</li>
    <li>Button to add new optimization step</li>
    <li>Button to remove current optimization step</li>
    <li>Template selection menu</li>
    <li>Template editor</li>
    <li>Button to save current optimization scheme to file</li>
    <li>Button to load optimization scheme from file</li>
</ol>

    <a class="anchor" id="gui-list">
        <br>
    </a>

<h3>Optimization step list</h3>
<p>This list shows the currently available optimization steps in the order that they will be performed. The optstep that is currently selected for editing is highlighted, and the editable optstep can be selected by clicking the appropriate entry.</p>

    <a class="anchor" id="gui-add">
        <br>
    </a>

<h3>Add new optimization step</h3>
<p>Clicking this button will append a new optimization step to the optstep list. The new optstep's templates will be copies of the currently selected optstep's templates.</p>

    <a class="anchor" id="gui-rem">
        <br>
    </a>

<h3>Remove current optimization step</h3>
<p>Click this button to delete the currently selected optimization step.</p>

    <a class="anchor" id="gui-tselect">
        <br>
    </a>

<h3>Select template</h3>
<p>This menu contains the filenames of the templates that are required by the currently selected queuing system (e.g. PBS, SGE, local...) and optimizer. The currently selected template is displayed in the template editor, and selecting a different template will update the editor.</p>

    <a class="anchor" id="gui-editor">
        <br>
    </a>

<h3>Template editor</h3>
<p>This text editor is used to view and edit the currently selected template for the current optstep.</p>

    <a class="anchor" id="gui-save">
        <br>
    </a>

<h3>Save scheme</h3>
<p>This button will prompt for a location to save a .scheme file containing the current optimization step.</p>

    <a class="anchor" id="gui-load">
        <br>
    </a>

<h3>Resume scheme</h3>
<p>This button will prompt for an existing .scheme file to load.</p>



    <a class="anchor" id="creating">
       <br><br>
    </a>

<h2>How to build an optimization scheme?</h2>
<p>Creating a working scheme from scratch may take some time. We recommend checking the samples/ directory of the source code to obtain sample scheme for each optimizer (see <a class="el" href="optschemes.html#loading">How to load an optimization scheme?</a>) and verifying that they are appropriate for the system under consideration before starting a search.</p>
<p>If there is not an appropriate sample, the following prescription may be used to generate your own:</p>

<ol align=left style="text-align:-moz-left" type="1">
    <li>Generate a random structure of the system under consideration. This may be done by hand, or by running a search just long enough to create the first random generation and saving one of the structures.</li>
    <li>Create a starting optstep with the desired convergence criteria</li>
    <li>Manually submit the optimization</li>
    <li>If the optimization fails:
        <ol type="a">
            <li>First determine why &ndash; if the maximum iterations were exceeded or the optimization was aborted due to a badly performing minimizer, try one of the ideas below. Other optimization problems are beyond the scope of this document.</li>
            <li>Reduce the convergence criteria of the current trial optstep</li>
            <li>Remove degrees of freedom, e.g. by fixing cell parameters, atomic positions, etc</li>
            <li>Reduce the accuracy of the calculation in other ways (use a courser integration grid, etc).</li>
            <li>Change the minimizer (e.g. tell the optimizer to use conjugate gradients rather than BFGS, etc)</li>
        </ol>
    </li>
    <li>Once the optimization succeeds, create another set of input files with the desired convergence criteria for all degrees of freedom.</li>
    <li>Manually submit the new optimization step. If it fails, try the ideas above until it converges.</li>
    <li>Once the structure has converged to the desired level of accuracy, try to optimize another randomly generated structure using the optsteps that succeeded previously. Refine them if needed.</li>
    <li>Once you have successfully optimized enough random structures that you are confident in your method, gather all of the inputs used and write your scheme from them.</li>
</ol>

<p>The scheme may be written by copying each input file into the template editor (with the appropriate optstep and template selected, of course) and replacing the structure-specific information with the appropriate keywords. Click the "Help" button for the complete list of keywords.</p>
<p>We have found that the optimization schemes are surprisingly transferable within an optimizer, so once you have a working optimization scheme for a given optimization code only minor tweaks (usually to the energy cutoffs, etc ) are necessary to use it on a different chemical system.</p>


    <a class="anchor" id="saving">
        <br><br>
    </a>

<h2>How to save an optimization scheme for later?</h2>
<p>Once you have written your optimization scheme, you will want to save it for fast retrieval later (otherwise you will need to copy/paste and edit all of the templates again!). To save, simply click the "Save Opt
Scheme" button and enter an appropriate filename with an extension of .scheme.</p>


    <a class="anchor" id="loading">
        <br><br>
    </a>

<h2>How to load an optimization scheme?</h2>
<p>Loading an optimization is quite simple &ndash; just click the "Load Opt
Scheme" button and select the .scheme file you wish to load. This will also update the current queuing system and optimizer to those specified by the scheme.</p>


    <a class="anchor" id="format">
        <br><br>
    </a>

<h2>What is saved?</h2>
<p>The optimization scheme files contain more than just the templates for each optstep. They also store queue and optimizer specific settings. This is useful for storing configuration options for different clusters along with the scheme. Note that although XtalOpt will prompt for an SSH password if needed, it is <b>NOT</b> stored in the scheme file.</p>


    <a class="anchor" id="suggest">
       <br><br>
    </a>

<h2>Suggestions for optimization schemes</h2>


<a class="anchor" id="sug-xtal">
       <br><br>
</a>

<h3>Crystals (XtalOpt)</h3>
<p>The following list describes the optimization steps used in the samples/vasp-xtalopt.scheme file distributed with the XtalOpt source code:</p>
<ol align=left style="text-align:-moz-left" type="1">
    <li>Fix unit cell, only optimize atomic coordinates. A very loose convergence criterion is used, and the number of KPOINTs is kept small.</li>
    <li>The cell volume is fixed, but atomic positions and cell parameters are allowed to vary. The convergence criteria is the same as before, as is the KPOINT grid.</li>
    <li>All degrees of freedom are considered using the same convergence criteria as before, but with a finer KPOINT grid.</li>
    <li>Same as before, but with a stricter convergence criteria.</li>
    <li>Same as before, but with a stricter convergence criteria and more KPOINTs.</li>
    <li>Same as before, but with more KPOINTs.</li>
</ol>
<p>This is only one of many possible optimization schemes that may work for crystals. It may need to be modified to work for your particular system. </p>
</div>



<!-- Save and Resume -->
    <a class="anchor" id="sr"> 
        <br><br>
    </a>

    <div class="jumbotron">
<h2>Saving and Resuming Sessions in XtalOpt</h2>
<img src="dist/img/xo-saveresume.png" alt="xo-saveresume.png" width="80%"/>



    <a class="anchor" id="sr_saving">
        <br><br>
    </a>

    <h3>How to save your session</h3>
    <p>XtalOpt will write a small file named xtalopt.state to its working directory that contains the information necessary to resume the session at a later time. The file can be rewritten manually by clicking the "Save Session" button highlighted above, and XtalOpt will automatically save the session every time a structure is updated.</p>
 <p>XtalOpt will also write a file "structure.state" in each candidate structure's directory. This file stores XtalOpt-specific information about the structure.</p>



    <a class="anchor" id="sr_resuming">
        <br><br>
    </a>

    <h3>How to resume your session</h3>
 <p>To resume a session, simply click "Resume stored session" (highlighted above) and select the xtalopt.state file in the working directory of the session you would like to resume. XtalOpt will then begin to load the structures and search parameters. You can monitor the progress with the progress bar that appears at the bottom of the window.</p>
 <p>While the structures are loading, you may encounter errors that say:</p>
 <div class="fragment"><pre class="fragment">
Error, no (or not appropriate for [OPTIMIZER]) xtal data in [DIRECTORY].

This could be a result of resuming a structure that has not yet done
any local optimizations. If so, safely ignore this message.</pre>
</div><p>As mentioned in the message, these can typically be ignored if it only happens for a handful of structures. This occurs when a structure has been generated in XtalOpt, but it has not completed any geometry optimizations so there are no output files from which to load the geometry. If it happens for a significant number of structures (or structures that are known to have completed at least one geometry optimization step), the output files from the optimizer may be missing or corrupt.</p>
 <p>After resuming a session, XtalOpt will ask if you would like to continue the search or enter read-only mode. Read-only mode will not generate new structures or submit geometry optimizations.</p>
 <dl class="note"><dt><b>Note:</b></dt><dd>If you are considering resuming a read-only session, take a look at the results.txt file in the working directory. It contains a list of all structures, sorted by enthalpy, with additional useful information. This can save some time when trying to locate the most stable structure of an old search.</dd></dl>
 <p>The working directories for XtalOpt are relocatable, meaning that the directory containing xtalopt.state and the [gen]x[id] structure folders may be moved, tarred, zipped, etc. and still be resumed at a later time from a different location on the filesystem, or even a different computer. </p>
</div>

        <br><br>

    <a class="anchor" id="randomdock">
        <br><br>
    </a>

      <div class="jumbotron">
        <h1>RandomDock Tutorial</h1>
        <br>
        <p>
          PDF format available <a class="el" target="_blank" href="docs/randomdock/latex/refman.pdf">here</a>
        </p>
      </div>

     <br><br>
     
     <div class="jumbotron">
     <p>RandomDock generates random structures of ensembles of molecules by arranging them in 3D space subject to several constraints:
       <ul align=left style="text-align:-moz-left">
         <li>One molecule is specified as the substrate</li>
         <li>One or more matrix molecules are added. These molecules will be used to form a cage around the substrate. Their stoichiometries may be adjusted to control the relative quantities of each.</li>

         <div class="image" align=center style="text-align:-moz-center"> 
           <img src="dist/img/rd-struct.png" alt="rd-struct.png" width="80%"/>
         </div>

         <li>The conformation and orientation of each matrix and substrate molecule is randomized in each scene.</li>
         <li>Matrix molecules are placed at random positions within a specified distance of the substrate's geometric center.</li>
         <li>One atom of each matrix molecule must be within a specified distance from any atom in the substrate.</li>
         <li>No two atoms from distinct molecules in the scene may be closer than a specified minimum distance.</li>
         <li>Optionally, it may be required that at least one possible hydrogen bond exists between each matrix molecule and any other molecule in the scene.</li>
       </ul>    
     </p>
     
     <p>Several of the constraints are parametrized, and may be modified via the user interface shown below.</p>

     <div class="image" align=center style="text-align:-moz-center"> 
       <img src="dist/img/rd-search.png" alt="rd-search.png" width="80%"/>
     </div>
     
     <p>After the scene has been generated, the atomic positions are optimized using either ADF, GAMESS, GAUSSIAN or MOPAC. The calculations may be performed on a remote supercomputing cluster by specifying SSH login details, or locally on the user's workstation. Remote calculations are automatically staged, copied, submitted, monitored, retrieved, and analyzed by RandomDock, making searches fully automatic. Configuration of remote computational resources and optimizer input files is performed using the same procedure as XtalOpt.</p>

     <p>The default behavior of RandomDock is to generate a single, possibly partial, shell of matrix molecules around the substrate, suitable for producing simple solvation models or studying binding interactions. Alternatively, it can be configured to generate molecular clusters. This mode produces clusters of molecules with randomized positions and orientations of molecules. A RandomDock search will continue until a specified number of scenes have been generated and optimized.

     <div class="image" align=center style="text-align:-moz-center"> 
       <img src="dist/img/rd-conformers.png" alt="rd-conformers.png" width="80%"/>
     </div>
     
     <p>Before any scenes are generated, a cached set of conformations for each molecule is generated. Conformers are relaxed and ranked using the forcefield implementations in the OpenBabel library. As shown above, the user specifies a forcefield implementation and a number of conformers for each molecule. By checking the All option, an exhaustive search is performed for all possible conformations of the molecule. Each conformer is assigned a probability according to the probability distribution (Eq. 1 in the main text). This probability is used during the generation of new scenes to favor usage of stable conformers in both the substrate and matrix molecules.</p>


</div>




<!-- start footer part -->
<br>
<p align="right" style="font-size:10pt;text-align:right">
Generated on Sun Apr 26 2015 01:32:48 for My Project by<a href="http://www.doxygen.org/index.html">
<img  src="dist/img/doxygen.png" alt="doxygen" align="absmiddle" style="width:10vw">
</a> 1.8.9.1
</p>

</div>

</body>
</html>
